       // @@@ ---  Creator SPooCK --- @@@   //
      //   @@@ --- Color Chat --- @@@      //
     //   @@@ --- Version 1.1.3--- @@@    //
    //  								 //
   // 		░░░░░███████ ]▄▄▄▄▄▄▄▄  	//
  //		▂▄▅█████████▅▄▃▂      	   //
 //		Il███████████████████].	  	  //
// 		 ◥⊙▲⊙▲⊙▲⊙▲⊙▲⊙▲⊙▲⊙▲⊙▲⊙◤..  	 //
 
function On_Command(o,t,n){switch(t){case"cforce":if(o.Admin)if(n.Length>=2){var a=n[0],e=GetPlayer(n[0]),r=e.SteamID,C=Data.ToLower(n[1]),i=colorCheck(C),s=colorCheckA(C),l=DataStore.Get("cSet",r);null!=e?s?(Server.BroadcastFrom("Color Chat",a+" is FORCED to use color [color#"+s+"] "+C),DataStore.Add("ColorChatC",r,null),DataStore.Add("ColorChat",r,s),DataStore.Add("cSet",r,s),DataStore.Save()):i?(Server.BroadcastFrom("Color Chat",a+" is FORCED to use color [color#"+i+"] "+C),DataStore.Add("ColorChatC",r,null),DataStore.Add("ColorChat",r,i),DataStore.Add("cSet",r,i),DataStore.Save()):"off"==C?(Server.BroadcastFrom("Color Chat",a+" is NOT FORCED to use [color#"+l+"]THIS COLOR[/color] !"),DataStore.Remove("cSet",r),DataStore.Save()):o.MessageFrom("Color Chat","There is no color "+C):o.MessageFrom("Color Chat","Player "+a+" not found !")}else o.MessageFrom("Color Chat","Use /cforce NAME COLOR to force player to use color");break;case"cforbid":if(o.Admin)if(n.Length>=1){var a=n[0],e=GetPlayer(n[0]),r=e.SteamID,d=DataStore.Get("cForbidI",r);null!=e?r!=d?(Server.BroadcastFrom("Color Chat","[color#FF0000][ADMIN][/color] "+o.Name+" has FORBIDDEN color chating for "+a+" !"),DataStore.Add("ColorChat",r,null),DataStore.Add("ColorChatC",r,null),DataStore.Add("cForbid",r,o.Name),DataStore.Add("cForbidI",r,r),DataStore.Save()):r==d&&(Server.BroadcastFrom("Color Chat","[color#FF0000][ADMIN][/color] "+o.Name+" has ALLOWED color chating for "+a+" !"),DataStore.Remove("cForbid",r),DataStore.Remove("cForbidI",r),DataStore.Save()):o.MessageFrom("Color Chat","Player "+a+" not found !")}else o.MessageFrom("Color Chat","Use /cforbid NAME to forbid player to use color");break;case"cname":if(o.Admin){var e=n[0];DataStore.Remove("cInvis",o.SteamID),o.MessageFrom("Color Chat","Your nick is set to: "+e),DataStore.Add("cInvis",o.SteamID,e)}break;case"cmcolor":o.Admin&&(Data.AddTableValue("CustomC",Server.Players,!GetMode(Players)),Server.BroadcastFrom("Color Chat","Command /color# is "+(GetMode(Players)?"enabled for players.":"disabled for players.")));break;case"colors":for(var S=Plugin.GetIni("ColorChat"),A=S.EnumSection("Color_Codes"),m=[],c=[],g=[],F=0;F<A.Length;F++)m[F]=S.GetSetting("Color_Codes",F+1),c[F]=S.GetSetting("Colors",F+1),g[F]="[color#"+m[F]+"]"+c[F];var D=g.join("[/color], ");if(o.MessageFrom("Color Chat","Colors: "+D),o.Admin){for(var S=Plugin.GetIni("ColorChat"),A=S.EnumSection("Admin_Codes"),m=[],c=[],g=[],F=0;F<A.Length;F++)m[F]=S.GetSetting("Admin_Codes",F+1),c[F]=S.GetSetting("Admin_Colors",F+1),g[F]="[color#"+m[F]+"]"+c[F];var D=g.join("[/color], ");o.MessageFrom("Color Chat","Admin Colors: "+D)}o.MessageFrom("Color Chat","Use /color NAME or /color off for disable. Type /color# ****** - where * is the color code.");break;case"color#":var h=n[0];0==GetMode(Players)&&o.Admin?h.Contains("1")||h.Contains("2")||h.Contains("3")||h.Contains("4")||h.Contains("5")||h.Contains("6")||h.Contains("7")||h.Contains("8")||h.Contains("9")||h.Contains("0")||h.Contains("A")||h.Contains("B")||h.Contains("C")||h.Contains("D")||h.Contains("E")||h.Contains("F")?6==h.Length?("000000"!=h&&"FAAFBE"!=h&&"F433FF"!=h&&"5EFB6E"!=h&&"00FF00"!=h&&"00FFFF"!=h&&"736AFF"!=h&&(o.MessageFrom("Color Chat","Set to [color#"+h+"]THIS COLOR[/color]"),DataStore.Add("ColorChat",o.SteamID,null),DataStore.Add("ColorChatC",o.SteamID,h),DataStore.Save()),("000000"==h&&o.Admin||"FAAFBE"==h&&o.Admin||"F433FF"==h&&o.Admin||"5EFB6E"==h&&o.Admin||"5EFB6E"==h&&o.Admin||"00FFFF"==h&&o.Admin||"736AFF"==h&&o.Admin)&&(o.MessageFrom("Color Chat","[color#"+h+"]Admin color ![/color]"),DataStore.Add("ColorChat",o.SteamID,null),DataStore.Add("ColorChatC",o.SteamID,h),DataStore.Save()),(h.Contains("Q")||h.Contains("W")||h.Contains("R")||h.Contains("T")||h.Contains("Y")||h.Contains("U")||h.Contains("I")||h.Contains("O")||h.Contains("P")||h.Contains("S")||h.Contains("G")||h.Contains("H")||h.Contains("J")||h.Contains("K")||h.Contains("L")||h.Contains("Z")||h.Contains("X")||h.Contains("V")||h.Contains("N")||h.Contains("M")||h.Contains("q")||h.Contains("w")||h.Contains("r")||h.Contains("i")||h.Contains("y")||h.Contains("u")||h.Contains("i")||h.Contains("o")||h.Contains("p")||h.Contains("s")||h.Contains("g")||h.Contains("h")||h.Contains("j")||h.Contains("k")||h.Contains("l")||h.Contains("z")||h.Contains("x")||h.Contains("v")||h.Contains("n")||h.Contains("m")||h.Contains("!")||h.Contains("@")||h.Contains("#")||h.Contains("$")||h.Contains("%")||h.Contains("^")||h.Contains("&")||h.Contains("*")||h.Contains("(")||h.Contains(")")||h.Contains("-")||h.Contains("_")||h.Contains("=")||h.Contains("+")||h.Contains("|")||h.Contains("{")||h.Contains("}")||h.Contains("[")||h.Contains("]")||h.Contains(";")||h.Contains(":")||h.Contains("'")||h.Contains(",")||h.Contains("<")||h.Contains(".")||h.Contains(">")||h.Contains("/")||h.Contains("?")||h.Contains("`")||h.Contains("~")||h.Contains("-")||h.Contains(" "))&&(o.MessageFrom("Color Chat","Use only VALID CODE string !"),DataStore.Add("ColorChatC",o.SteamID,null))):o.MessageFrom("Color Chat","Use only 6 CODE string !"):o.MessageFrom("Color Chat","Use only VALID CODE string !"):1==GetMode(Players)?h.Contains("1")||h.Contains("2")||h.Contains("3")||h.Contains("4")||h.Contains("5")||h.Contains("6")||h.Contains("7")||h.Contains("8")||h.Contains("9")||h.Contains("0")||h.Contains("A")||h.Contains("B")||h.Contains("C")||h.Contains("D")||h.Contains("E")||h.Contains("F")?6==h.Length?("000000"!=h&&"FAAFBE"!=h&&"F433FF"!=h&&"5EFB6E"!=h&&"00FF00"!=h&&"00FFFF"!=h&&"736AFF"!=h&&(o.MessageFrom("Color Chat","Set to [color#"+h+"]THIS COLOR[/color]"),DataStore.Add("ColorChat",o.SteamID,null),DataStore.Add("ColorChatC",o.SteamID,h),DataStore.Save()),("000000"==h&&o.Admin||"FAAFBE"==h&&o.Admin||"F433FF"==h&&o.Admin||"5EFB6E"==h&&o.Admin||"5EFB6E"==h&&o.Admin||"00FFFF"==h&&o.Admin||"736AFF"==h&&o.Admin)&&(o.MessageFrom("Color Chat","[color#"+h+"]Admin color ![/color]"),DataStore.Add("ColorChat",o.SteamID,null),DataStore.Add("ColorChatC",o.SteamID,h),DataStore.Save()),(h.Contains("Q")||h.Contains("W")||h.Contains("R")||h.Contains("T")||h.Contains("Y")||h.Contains("U")||h.Contains("I")||h.Contains("O")||h.Contains("P")||h.Contains("S")||h.Contains("G")||h.Contains("H")||h.Contains("J")||h.Contains("K")||h.Contains("L")||h.Contains("Z")||h.Contains("X")||h.Contains("V")||h.Contains("N")||h.Contains("M")||h.Contains("q")||h.Contains("w")||h.Contains("r")||h.Contains("i")||h.Contains("y")||h.Contains("u")||h.Contains("i")||h.Contains("o")||h.Contains("p")||h.Contains("s")||h.Contains("g")||h.Contains("h")||h.Contains("j")||h.Contains("k")||h.Contains("l")||h.Contains("z")||h.Contains("x")||h.Contains("v")||h.Contains("n")||h.Contains("m")||h.Contains("!")||h.Contains("@")||h.Contains("#")||h.Contains("$")||h.Contains("%")||h.Contains("^")||h.Contains("&")||h.Contains("*")||h.Contains("(")||h.Contains(")")||h.Contains("-")||h.Contains("_")||h.Contains("=")||h.Contains("+")||h.Contains("|")||h.Contains("{")||h.Contains("}")||h.Contains("[")||h.Contains("]")||h.Contains(";")||h.Contains(":")||h.Contains("'")||h.Contains(",")||h.Contains("<")||h.Contains(".")||h.Contains(">")||h.Contains("/")||h.Contains("?")||h.Contains("`")||h.Contains("~")||h.Contains("-")||h.Contains(" "))&&(o.MessageFrom("Color Chat","Use only VALID CODE string !"),DataStore.Add("ColorChatC",o.SteamID,null))):o.MessageFrom("Color Chat","Use only 6 CODE string !"):o.MessageFrom("Color Chat","Use only VALID CODE string !"):0==GetMode(Players)&&o.MessageFrom("Color Chat","Command is currently only for admins !");break;case"color":var u=DataStore.Get("cForbid",o.SteamID),l=DataStore.Get("cSet",o.SteamID),C=Data.ToLower(n[0]),i=colorCheck(C),s=colorCheckA(C);null==u?null==l?"off"==C?(o.MessageFrom("Color Chat","Colors are turned Off"),DataStore.Add("ColorChat",o.SteamID,null),DataStore.Add("ColorChatC",o.SteamID,null)):s&&o.Admin?(o.MessageFrom("Color Chat","[color#"+s+"] Admin Color !"),DataStore.Add("ColorChatC",o.SteamID,null),DataStore.Add("ColorChat",o.SteamID,s),DataStore.Save()):i?(o.MessageFrom("Color Chat","Color is set to [color#"+i+"] "+C),DataStore.Add("ColorChatC",o.SteamID,null),DataStore.Add("ColorChat",o.SteamID,i),DataStore.Save()):o.Admin?2!=n.Length?o.MessageFrom("Color Chat","To add a color type: /color NAME CODE"):6!=n[1].Length?o.MessageFrom("Color Chat","Use only 6 CODE string !"):n[1].match(/[^A-F0-9]/g)?o.MessageFrom("Color Chat","Use only VALID CODE string !"):addColor(o,n[0],n[1]):o.MessageFrom("Color Chat",n[0]+" don't have such a color !"):o.MessageFrom("Color Chat","You are FORCED to use only [color#"+l+"]THIS COLOR"):o.MessageFrom("Color Chat","[color#FF0000][ADMIN][/color] "+u+" is FORBIDDEN you color chating !");break;case"colora":o.Admin&&(2!=n.Length?o.MessageFrom("Color Chat","To add ADMIN color type: /colora NAME CODE"):6!=n[1].Length?o.MessageFrom("Color Chat","Use only 6 CODE string !"):n[1].match(/[^A-F0-9]/g)?o.MessageFrom("Color Chat","Use only VALID CODE string !"):addColorA(o,n[0],n[1]));break;case"colorr":if(o.Admin){var C=Data.ToLower(n[0]),i=colorCheck(C);i?remColor(o,n[0]):o.MessageFrom("Color Chat","To remove a color: /colorr NAME")}break;case"colorra":if(o.Admin){var C=Data.ToLower(n[0]),i=colorCheckA(C);i?remColorA(o,n[0]):o.MessageFrom("Color Chat","To remove an admin color: /colorra NAME")}}}function On_Chat(o,t){for(var n=t.ToString(),a=(Data.ToLower(n),0),e=0,r=[],C=t.toString(),i=DataStore.Get("ColorChat",o.SteamID),s="[color#"+i+"]",l=s+C,d=l.split('"'),S=DataStore.Get("ColorChatC",o.SteamID),A="[color#"+S+"]",m=A+C,c=m.split('"'),g=DataStore.Get("cInvis",o.SteamID);1>e;){var F=Plugin.GetIni("ColorChat"),D=F.GetSetting("Baned_Comm",a+1);if(null==D){e++;break}r[a]=D,a++}for(var h=0;h<r.length;h++)if(n.Contains(r[h])){return o.MessageFrom("Color Chat","Don't try to customize colors use the Color Chat instead ! "),void(t.NewText="");var h}if(null!=i&&null==S){var u=d.join("");t.NewText='"'+u+'"'}if(null!=S&&null==i){var v=c.join("");t.NewText='"'+v+'"'}if(null==i&&null==S&&o.Admin&&""==o.Name&&o.MessageFrom("Color Chat","You have to use /color NAME before you can chat !"),null!=i&&null==S&&o.Admin&&""==o.Name)if(null!=g){var u=d.join("");Server.BroadcastFrom(g,u)}else o.MessageFrom("Color Chat","You have to use /cname NAME before you can chat !");if(null!=S&&null==i&&o.Admin&&""==o.Name)if(null!=g){var v=c.join("");Server.BroadcastFrom(g,v)}else o.MessageFrom("Color Chat","You have to use /cname NAME before you can chat !")}function On_PluginInit(){if(!Plugin.IniExists("ColorChat")){var o=Plugin.CreateIni("ColorChat");o.AddSetting("Baned_Comm",1,"[color#"),o.AddSetting("Baned_Comm",2,"[color #"),o.AddSetting("Baned_Comm",3,"[color"),o.AddSetting("Baned_Comm",4,"[color "),o.AddSetting("ConnDisc","Connect","FF0000"),o.AddSetting("ConnDisc","Disconnect","00FF00"),o.AddSetting("Colors",1,"Red"),o.AddSetting("Colors",2,"Blue"),o.AddSetting("Colors",3,"Purple"),o.AddSetting("Colors",4,"Yellow"),o.AddSetting("Colors",5,"Pink"),o.AddSetting("Colors",6,"Orange"),o.AddSetting("Colors",7,"Green"),o.AddSetting("Colors",8,"Teal"),o.AddSetting("Colors",9,"Lime"),o.AddSetting("Colors",10,"Brown"),o.AddSetting("Colors",11,"Silver"),o.AddSetting("Colors",12,"Maroon"),o.AddSetting("Colors",13,"Olive"),o.AddSetting("Admin_Colors",1,"Black"),o.AddSetting("Admin_Colors",2,"HPink"),o.AddSetting("Admin_Colors",3,"NPink"),o.AddSetting("Admin_Colors",4,"DGreen"),o.AddSetting("Admin_Colors",5,"JGreen"),o.AddSetting("Admin_Colors",6,"Cyan"),o.AddSetting("Admin_Colors",7,"SBlue"),o.AddSetting("Color_Codes",1,"FF0000"),o.AddSetting("Color_Codes",2,"1F45FC"),o.AddSetting("Color_Codes",3,"800080"),o.AddSetting("Color_Codes",4,"FFFF00"),o.AddSetting("Color_Codes",5,"F660AB"),o.AddSetting("Color_Codes",6,"FFA500"),o.AddSetting("Color_Codes",7,"008000"),o.AddSetting("Color_Codes",8,"008080"),o.AddSetting("Color_Codes",9,"6AFB92"),o.AddSetting("Color_Codes",10,"A52A2A"),o.AddSetting("Color_Codes",11,"C0C0C0"),o.AddSetting("Color_Codes",12,"800000"),o.AddSetting("Color_Codes",13,"808000"),o.AddSetting("Admin_Codes",1,"000000"),o.AddSetting("Admin_Codes",2,"FAAFBE"),o.AddSetting("Admin_Codes",3,"F433FF"),o.AddSetting("Admin_Codes",4,"5EFB6E"),o.AddSetting("Admin_Codes",5,"00FF00"),o.AddSetting("Admin_Codes",6,"00FFFF"),o.AddSetting("Admin_Codes",7,"736AFF"),o.Save()}}function GetMode(){var o=Data.GetTableValue("CustomC",Server.Players);return null==o?!1:o}function On_PlayerConnected(o){var t=Plugin.GetIni("ColorChat"),n=t.GetSetting("ConnDisc","Connect");"false"!=n&&Server.Broadcast("[color#"+n+"] "+o.Name+"[/color] is connecting to server.");var a=DataStore.Get("cInvis",o.SteamID);o.Admin&&""==o.Name&&null!=a?Server.Broadcast("[color#FF0000][INV][/color] "+a+" is connecting."):o.Admin&&""==o.Name&&null==a&&Server.Broadcast("[color#FF0000][INV][/color] is connecting.")}function On_PlayerDisconnected(o){var t=Plugin.GetIni("ColorChat"),n=t.GetSetting("ConnDisc","Disconnect");"false"!=n&&Server.Broadcast("[color#"+n+"] "+o.Name+"[/color] disconnected from server.")}function GetPlayer(o){o=Data.ToLower(o);for(pl in Server.Players)if(Data.ToLower(pl.Name)==o)return pl;return null}function addColor(o,t,n){for(var a=Plugin.GetIni("ColorChat"),e=1,r=a.GetSetting("Colors",e);null!=r;){e++;var r=a.GetSetting("Colors",e)}a.AddSetting("Colors",e,t),a.AddSetting("Color_Codes",e,n),a.Save(),o.MessageFrom("Color Chat","[color#"+n+"]"+t+"[/color] COLOR ADDED !")}function colorCheck(o){for(var t=Plugin.GetIni("ColorChat"),n=t.EnumSection("Colors"),a=1;a<n.Length+1;a++){var e=t.GetSetting("Colors",a),r=t.GetSetting("Color_Codes",a);if(o==Data.ToLower(e))return r}return!1}function addColorA(o,t,n){for(var a=Plugin.GetIni("ColorChat"),e=1,r=a.GetSetting("Admin_Colors",e);null!=r;){e++;var r=a.GetSetting("Admin_Colors",e)}a.AddSetting("Admin_Colors",e,t),a.AddSetting("Admin_Codes",e,n),a.Save(),o.MessageFrom("Color Chat","[color#"+n+"]"+t+"[/color] ADMIN COLOR ADDED !")}function colorCheckA(o){for(var t=Plugin.GetIni("ColorChat"),n=t.EnumSection("Admin_Colors"),a=1;a<n.Length+1;a++){var e=t.GetSetting("Admin_Colors",a),r=t.GetSetting("Admin_Codes",a);if(o==Data.ToLower(e))return r}return!1}function remColor(o,t){for(var n=Plugin.GetIni("ColorChat"),a=n.EnumSection("Colors"),e=a.Length,r=1;e+1>r;r++){var C=n.GetSetting("Colors",r);if(t==Data.ToLower(C)){for(var i=r,s=e-i,l=0;s>l;l++){i++;var d=n.GetSetting("Colors",i),S=n.GetSetting("Color_Codes",i),A=i-1;n.AddSetting("Colors",A,d),n.AddSetting("Color_Codes",A,S)}return n.DeleteSetting("Colors",e),n.DeleteSetting("Color_Codes",e),n.Save(),void o.MessageFrom("Color Chat",t+" REMOVED")}}}function remColorA(o,t){for(var n=Plugin.GetIni("ColorChat"),a=n.EnumSection("Admin_Colors"),e=a.Length,r=1;e+1>r;r++){var C=n.GetSetting("Admin_Colors",r);if(t==Data.ToLower(C)){for(var i=r,s=e-i,l=0;s>l;l++){i++;var d=n.GetSetting("Admin_Colors",i),S=n.GetSetting("Admin_Codes",i),A=i-1;n.AddSetting("Admin_Colors",A,d),n.AddSetting("Admin_Codes",A,S)}return n.DeleteSetting("Admin_Colors",e),n.DeleteSetting("Admin_Codes",e),n.Save(),void o.MessageFrom("Color Chat",t+" REMOVED")}}}